<mat-card class="card">
  <mat-card-content>
    <svg
      width="100%"
      height="100%"
      preserveAspectRatio="xMinYMin meet"
      [attr.viewBox]="'0 0 ' + (width+margin.left+margin.right) + ' ' + (height+margin.top+margin.bottom)"
      [style.max-width]="500"
      [style.max-height]="500">
      <g [attr.transform]="'translate(' + margin.left + ',' + margin.top + ')'">
        <g *ngIf="controlsService.controls?.edges">
          <line *ngFor="let link of _network?.links"
                class="line"
                [attr.x1]="getCoordinate(link.source, 'x')"
                [attr.y1]="getCoordinate(link.source, 'y')"
                [attr.x2]="getCoordinate(link.target, 'x')"
                [attr.y2]="getCoordinate(link.target, 'y')"
          ></line>
        </g>
        <g *ngIf="controlsService.controls?.tree">
          <line *ngFor="let link of _network?.treeEdges"
                class="line strong"
                [attr.x1]="getCoordinateByNodeId(link[0], 'x')"
                [attr.y1]="getCoordinateByNodeId(link[0], 'y')"
                [attr.x2]="getCoordinateByNodeId(link[1], 'x')"
                [attr.y2]="getCoordinateByNodeId(link[1], 'y')"
          ></line>
        </g>
        <g *ngFor="let node of _network?.nodes"
           class="node"
           [attr.transform]="'translate(' + node.info!!.position[0] + ',' + (height-node.info!!.position[1]) + ')'"
        > <!-- TODO watch out for null safety! -->
          <circle
            *ngIf="controlsService.controls?.nodes"
            r="6"
            style="stroke: #000000"
            [style.fill]="colorMap[node?.info?.status || ''] || '#FF0000'"
            (click)="onNodeClick(node)">
          </circle>
          <text *ngIf="controlsService.controls?.labels"
                dx="12"
                dy=".35em">
            {{node.info?.id}}
          </text>
        </g>
      </g>
    </svg>
  </mat-card-content>
  <mat-divider inset></mat-divider>
  <mat-card-footer>
    <div *ngFor="let status of _network?.currentAlgorithm?.statusKeys">
      <div class="status-indicator" [style.background]="colorMap[status]"></div>
      <span>{{status}}</span>
    </div>
  </mat-card-footer>
</mat-card>
